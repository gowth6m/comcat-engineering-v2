datasource db {
    provider = "mongodb"
    url      = env("DATABASE_URL")
}

generator client {
    provider = "prisma-client-js"
}

model Product {
    id           String      @id @default(auto()) @map("_id") @db.ObjectId
    name         String
    slug         String
    category     String[]
    image        String
    brand        String
    price        Float
    rating       Float
    numReviews   Int
    countInStock Int
    description  String
    createdAt    DateTime    @default(now())
    updatedAt    DateTime    @updatedAt
    orderItem    OrderItem[]
    review       Review[]
}

model User {
    id        String   @id @default(auto()) @map("_id") @db.ObjectId
    firstName String
    lastName  String
    email     String   @unique
    password  String
    isAdmin   Boolean  @default(false)
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    order     Order[]
    review    Review[]
}

model Order {
    id              String      @id @default(auto()) @map("_id") @db.ObjectId
    user            User        @relation(fields: [userId], references: [id])
    userId          String      @db.ObjectId
    orderItems      OrderItem[]
    shippingAddress String
    paymentMethod   String
    paymentResult   String
    taxPrice        Float
    shippingPrice   Float
    totalPrice      Float
    isPaid          Boolean     @default(false)
    paidAt          DateTime
    isDelivered     Boolean     @default(false)
    deliveredAt     DateTime
    createdAt       DateTime    @default(now())
    updatedAt       DateTime    @updatedAt
}

model OrderItem {
    id        String  @id @default(auto()) @map("_id") @db.ObjectId
    product   Product @relation(fields: [productId], references: [id])
    productId String  @db.ObjectId
    name      String
    image     String
    price     Float
    qty       Int
    order     Order?  @relation(fields: [orderId], references: [id])
    orderId   String? @db.ObjectId
}

model Review {
    id        String   @id @default(auto()) @map("_id") @db.ObjectId
    user      User     @relation(fields: [userId], references: [id])
    userId    String   @db.ObjectId
    product   Product  @relation(fields: [productId], references: [id])
    productId String   @db.ObjectId
    name      String
    rating    Float
    comment   String
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
}
